
Step 1: Learn Vocab ...
../steps/learn_vocab.sh --config-file test/tmp/case-01/conf/vocab.conf ./data/train test/tmp/case-01/exp
**Learning vocab test/tmp/case-01/exp/vocab.clm from ./data/train
Succeeded learning vocab: 
  Words:  81350
  Vocab size:  3721
Elapse time: 0hr0m3s

Step 2: Train MaxEnt model ...
../steps/init_model.sh --init-config-file test/tmp/case-01/conf/maxent/init.conf --output-config-file test/tmp/case-01/conf/maxent/output.conf --class-size  --train-file ./data/train --train-config test/tmp/case-01/conf/maxent/train.conf --train-threads 1 test/tmp/case-01/exp/vocab.clm test/tmp/case-01/exp/maxent
**Initializing model test/tmp/case-01/exp/vocab.clm to test/tmp/case-01/exp/maxent/init.clm ...
Elapse time: 0hr0m0s
../steps/train_model.sh --train-config test/tmp/case-01/conf/maxent/train.conf --test-config test/tmp/case-01/conf/test.conf --train-threads 1 --test-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/maxent
Prerun Valid Entropy: 8.857599
ITERATION 01: TrEnt 7.654613, lr(0.1/0.005/0.1/0.1), W/s 152.5k, CVEnt: 7.472479
nnet accepted (01.clm)
ITERATION 02: TrEnt 7.323317, lr(0.1/0.005/0.1/0.1), W/s 154.6k, CVEnt: 7.381970
nnet accepted (02.clm)
ITERATION 03: TrEnt 7.192577, lr(0.1/0.005/0.1/0.1), W/s 154.9k, CVEnt: 7.322546
nnet accepted (03.clm)
ITERATION 04: TrEnt 7.099745, lr(0.1/0.005/0.1/0.1), W/s 122.6k, CVEnt: 7.277242
nnet accepted (04.clm)
ITERATION 05: TrEnt 7.025896, lr(0.1/0.005/0.1/0.1), W/s 151.7k, CVEnt: 7.246377
nnet accepted (05.clm)
ITERATION 06: TrEnt 6.965199, lr(0.1/0.005/0.1/0.1), W/s 152.3k, CVEnt: 7.214610
nnet accepted (06.clm)
ITERATION 07: TrEnt 6.911551, lr(0.1/0.005/0.1/0.1), W/s 140.9k, CVEnt: 7.191189
nnet accepted (07.clm)
ITERATION 08: TrEnt 6.863892, lr(0.1/0.005/0.1/0.1), W/s 150.3k, CVEnt: 7.174837
nnet accepted (08.clm)
ITERATION 09: TrEnt 6.825596, lr(0.05/0.0025/0.05/0.05), W/s 152.3k, CVEnt: 7.161742
nnet accepted (09.clm)
ITERATION 10: TrEnt 6.807102, lr(0.025/0.00125/0.025/0.025), W/s 151.1k, CVEnt: 7.154966
nnet accepted (10.clm)
ITERATION 11: TrEnt 6.798021, lr(0.0125/0.000625/0.0125/0.0125), W/s 151.7k, CVEnt: 7.153679
nnet accepted (11.clm)
finished, too small rel. improvement .0001798750
Succeeded training the Neural Network : test/tmp/case-01/exp/maxent/final.clm
Elapse time: 0hr0m10s
Effective speed: 89.4k words/sec
../steps/test_model.sh --config-file test/tmp/case-01/conf/test.conf --test-threads 1 test/tmp/case-01/exp/maxent ./data/test
**Testing model test/tmp/case-01/exp/maxent/final.clm ...
=================================
Test Entropy: 7.039683
Test PPL: 131.569644
Test Speed: 180.8k words/sec
=================================
Elapse time: 0hr0m0s

Step 3: Train RNN model ...
../steps/init_model.sh --init-config-file test/tmp/case-01/conf/rnn/init.conf --output-config-file test/tmp/case-01/conf/rnn/output.conf --class-size  --train-file ./data/train --train-config test/tmp/case-01/conf/rnn/train.conf --train-threads 1 test/tmp/case-01/exp/vocab.clm test/tmp/case-01/exp/rnn
**Initializing model test/tmp/case-01/exp/vocab.clm to test/tmp/case-01/exp/rnn/init.clm ...
Elapse time: 0hr0m0s
../steps/train_model.sh --train-config test/tmp/case-01/conf/rnn/train.conf --test-config test/tmp/case-01/conf/test.conf --train-threads 1 --test-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/rnn
Prerun Valid Entropy: 8.919792
ITERATION 01: TrEnt 7.163846, lr(0.1/0.001/0.1/0.1), W/s 44.5k, CVEnt: 7.071594
nnet accepted (01.clm)
ITERATION 02: TrEnt 6.778829, lr(0.1/0.001/0.1/0.1), W/s 44.6k, CVEnt: 6.989743
nnet accepted (02.clm)
ITERATION 03: TrEnt 6.649918, lr(0.1/0.001/0.1/0.1), W/s 44.9k, CVEnt: 6.917487
nnet accepted (03.clm)
ITERATION 04: TrEnt 6.565709, lr(0.1/0.001/0.1/0.1), W/s 44.6k, CVEnt: 6.927956
nnet rejected (04.clm)
ITERATION 05: TrEnt 6.525847, lr(0.05/0.0005/0.05/0.05), W/s 44.7k, CVEnt: 6.892374
nnet accepted (05.clm)
ITERATION 06: TrEnt 6.458633, lr(0.025/0.00025/0.025/0.025), W/s 44.5k, CVEnt: 6.898715
nnet rejected (06.clm)
finished, too small rel. improvement 0
Succeeded training the Neural Network : test/tmp/case-01/exp/rnn/final.clm
Elapse time: 0hr0m13s
Effective speed: 37.5k words/sec
../steps/test_model.sh --config-file test/tmp/case-01/conf/test.conf --test-threads 1 test/tmp/case-01/exp/rnn ./data/test
**Testing model test/tmp/case-01/exp/rnn/final.clm ...
=================================
Test Entropy: 6.772412
Test PPL: 109.319858
Test Speed: 123.1k words/sec
=================================
Elapse time: 0hr0m0s

Step 4: Train RNN+MaxEnt model ...
../steps/init_model.sh --init-config-file test/tmp/case-01/conf/rnn+maxent/init.conf --output-config-file test/tmp/case-01/conf/rnn+maxent/output.conf --class-size  --train-file ./data/train --train-config test/tmp/case-01/conf/rnn+maxent/train.conf --train-threads 1 test/tmp/case-01/exp/vocab.clm test/tmp/case-01/exp/rnn+maxent
**Initializing model test/tmp/case-01/exp/vocab.clm to test/tmp/case-01/exp/rnn+maxent/init.clm ...
Elapse time: 0hr0m0s
../steps/train_model.sh --train-config test/tmp/case-01/conf/rnn+maxent/train.conf --test-config test/tmp/case-01/conf/test.conf --train-threads 1 --test-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/rnn+maxent
Prerun Valid Entropy: 8.875496
ITERATION 01: TrEnt 6.854907, lr(0.5/0.1/0.5/0.5), W/s 39.7k, CVEnt: 6.804198
nnet accepted (01.clm)
ITERATION 02: TrEnt 6.233056, lr(0.5/0.1/0.5/0.5), W/s 39.7k, CVEnt: 6.758265
nnet accepted (02.clm)
ITERATION 03: TrEnt 5.914905, lr(0.5/0.1/0.5/0.5), W/s 39.7k, CVEnt: 6.669926
nnet accepted (03.clm)
ITERATION 04: TrEnt 5.678703, lr(0.5/0.1/0.5/0.5), W/s 40.0k, CVEnt: 6.656306
nnet accepted (04.clm)
ITERATION 05: TrEnt 5.402022, lr(0.25/0.05/0.25/0.25), W/s 39.0k, CVEnt: 6.576193
nnet accepted (05.clm)
ITERATION 06: TrEnt 5.268356, lr(0.125/0.025/0.125/0.125), W/s 40.0k, CVEnt: 6.568039
nnet accepted (06.clm)
ITERATION 07: TrEnt 5.200272, lr(0.0625/0.0125/0.0625/0.0625), W/s 39.2k, CVEnt: 6.561880
nnet accepted (07.clm)
ITERATION 08: TrEnt 5.166449, lr(0.03125/0.00625/0.03125/0.03125), W/s 40.2k, CVEnt: 6.560209
nnet accepted (08.clm)
finished, too small rel. improvement .0002546526
Succeeded training the Neural Network : test/tmp/case-01/exp/rnn+maxent/final.clm
Elapse time: 0hr0m19s
Effective speed: 34.2k words/sec
../steps/test_model.sh --config-file test/tmp/case-01/conf/test.conf --test-threads 1 test/tmp/case-01/exp/rnn+maxent ./data/test
**Testing model test/tmp/case-01/exp/rnn+maxent/final.clm ...
=================================
Test Entropy: 6.431340
Test PPL: 86.303070
Test Speed: 99.9k words/sec
=================================
Elapse time: 0hr0m0s

Step 5: Train RNN~MaxEnt merge model ...
Training MaxEnt...
../steps/init_model.sh --init-config-file test/tmp/case-01/conf/maxent~rnn/maxent/init.conf --output-config-file test/tmp/case-01/conf/maxent~rnn/maxent/output.conf --class-size  --train-file ./data/train --train-config test/tmp/case-01/conf/maxent~rnn/maxent/train.conf --train-threads 1 test/tmp/case-01/exp/vocab.clm test/tmp/case-01/exp/maxent~rnn/maxent
**Initializing model test/tmp/case-01/exp/vocab.clm to test/tmp/case-01/exp/maxent~rnn/maxent/init.clm ...
Elapse time: 0hr0m0s
../steps/train_model.sh --train-config test/tmp/case-01/conf/maxent~rnn/maxent/train.conf --test-config test/tmp/case-01/conf/test.conf --train-threads 1 --test-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/maxent~rnn/maxent
Prerun Valid Entropy: 8.857599
ITERATION 01: TrEnt 7.654613, lr(0.1/0.005/0.1/0.1), W/s 154.3k, CVEnt: 7.472479
nnet accepted (01.clm)
ITERATION 02: TrEnt 7.323317, lr(0.1/0.005/0.1/0.1), W/s 146.2k, CVEnt: 7.381970
nnet accepted (02.clm)
ITERATION 03: TrEnt 7.192577, lr(0.1/0.005/0.1/0.1), W/s 152.8k, CVEnt: 7.322546
nnet accepted (03.clm)
ITERATION 04: TrEnt 7.099745, lr(0.1/0.005/0.1/0.1), W/s 150.6k, CVEnt: 7.277242
nnet accepted (04.clm)
ITERATION 05: TrEnt 7.025896, lr(0.1/0.005/0.1/0.1), W/s 151.4k, CVEnt: 7.246377
nnet accepted (05.clm)
ITERATION 06: TrEnt 6.965199, lr(0.1/0.005/0.1/0.1), W/s 149.5k, CVEnt: 7.214610
nnet accepted (06.clm)
ITERATION 07: TrEnt 6.911551, lr(0.1/0.005/0.1/0.1), W/s 152.3k, CVEnt: 7.191189
nnet accepted (07.clm)
ITERATION 08: TrEnt 6.863892, lr(0.1/0.005/0.1/0.1), W/s 151.4k, CVEnt: 7.174837
nnet accepted (08.clm)
ITERATION 09: TrEnt 6.825596, lr(0.05/0.0025/0.05/0.05), W/s 151.7k, CVEnt: 7.161742
nnet accepted (09.clm)
ITERATION 10: TrEnt 6.807102, lr(0.025/0.00125/0.025/0.025), W/s 151.4k, CVEnt: 7.154966
nnet accepted (10.clm)
ITERATION 11: TrEnt 6.798021, lr(0.0125/0.000625/0.0125/0.0125), W/s 153.1k, CVEnt: 7.153679
nnet accepted (11.clm)
finished, too small rel. improvement .0001798750
Succeeded training the Neural Network : test/tmp/case-01/exp/maxent~rnn/maxent/final.clm
Elapse time: 0hr0m9s
Effective speed: 99.4k words/sec
../steps/test_model.sh --config-file test/tmp/case-01/conf/test.conf --test-threads 1 test/tmp/case-01/exp/maxent~rnn/maxent ./data/test
**Testing model test/tmp/case-01/exp/maxent~rnn/maxent/final.clm ...
=================================
Test Entropy: 7.039683
Test PPL: 131.569644
Test Speed: 184.7k words/sec
=================================
Elapse time: 0hr0m1s
Initializing RNN...
../steps/init_model.sh --init-config-file test/tmp/case-01/conf/maxent~rnn/rnn/init.conf --hs  true --class-size  100 --train-file ./data/train --train-config test/tmp/case-01/conf/maxent~rnn/train.conf --train-threads 1 test/tmp/case-01/exp/vocab.clm test/tmp/case-01/exp/maxent~rnn/rnn
**Initializing model test/tmp/case-01/exp/vocab.clm to test/tmp/case-01/exp/maxent~rnn/rnn/init.clm ...
****Trying class size: 100 ...
****Class size: 100, Speed:  39538.6.
**Best model: test/tmp/case-01/exp/maxent~rnn/rnn/init/init.100.clm, Speed:  39538.6.
Elapse time: 0hr0m2s
Mergine MaxEnt~RNN...
Training MaxEnt~RNN...
../steps/train_model.sh --train-config test/tmp/case-01/conf/maxent~rnn//train.conf --test-config test/tmp/case-01/conf/test.conf --train-threads 1 --test-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/maxent~rnn/
Prerun Valid Entropy: 7.163129
ITERATION 01: TrEnt 6.608788, lr(0.5/0.1/0.5/0.5), W/s 39.6k, CVEnt: 6.867746
nnet accepted (01.clm)
ITERATION 02: TrEnt 6.168124, lr(0.5/0.1/0.5/0.5), W/s 40.2k, CVEnt: 6.811410
nnet accepted (02.clm)
ITERATION 03: TrEnt 5.880777, lr(0.5/0.1/0.5/0.5), W/s 40.0k, CVEnt: 6.727864
nnet accepted (03.clm)
ITERATION 04: TrEnt 5.655678, lr(0.5/0.1/0.5/0.5), W/s 40.0k, CVEnt: 6.715947
nnet accepted (04.clm)
ITERATION 05: TrEnt 5.402588, lr(0.25/0.05/0.25/0.25), W/s 39.7k, CVEnt: 6.634975
nnet accepted (05.clm)
ITERATION 06: TrEnt 5.278548, lr(0.125/0.025/0.125/0.125), W/s 40.3k, CVEnt: 6.633567
nnet accepted (06.clm)
finished, too small rel. improvement .0002122087
Succeeded training the Neural Network : test/tmp/case-01/exp/maxent~rnn//final.clm
Elapse time: 0hr0m14s
Effective speed: 34.8k words/sec
../steps/test_model.sh --config-file test/tmp/case-01/conf/test.conf --test-threads 1 test/tmp/case-01/exp/maxent~rnn/ ./data/test
**Testing model test/tmp/case-01/exp/maxent~rnn//final.clm ...
=================================
Test Entropy: 6.516645
Test PPL: 91.559982
Test Speed: 97.6k words/sec
=================================
Elapse time: 0hr0m0s
