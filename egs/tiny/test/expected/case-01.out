
Step 1: Learn Vocab ...
../steps/learn_vocab.sh --config-file test/tmp/case-01/exp/conf/vocab.conf ./data/train test/tmp/case-01/exp
../steps/learn_vocab.sh: Learning vocab test/tmp/case-01/exp/vocab.clm from ./data/train
=================================
Words:  81350
Vocab size:  3721
=================================
../steps/learn_vocab.sh: Elapse time: 0hr0m1s

Step 2: Train MaxEnt model ...
../steps/run_standalone.sh --class-size  --train-thr 1 --test-thr 1 maxent test/tmp/case-01/exp/conf test/tmp/case-01/exp ./data/train ./data/valid ./data/test
../steps/run_standalone.sh: Stage 1 --- Initialising model...
../steps/init_model.sh --init-config-file test/tmp/case-01/exp/conf/maxent/init.conf --output-config-file test/tmp/case-01/exp/conf/maxent/output.conf --class-size  --hs  --train-file ./data/train --train-config test/tmp/case-01/exp/conf/maxent/train.conf --train-threads 1 test/tmp/case-01/exp/vocab.clm test/tmp/case-01/exp/maxent
../steps/init_model.sh: Initializing model test/tmp/case-01/exp/vocab.clm to test/tmp/case-01/exp/maxent/init.clm ...
../steps/init_model.sh: Elapse time: 0hr0m1s
../steps/run_standalone.sh: Stage 2 --- Training model...
../steps/train_model.sh --train-config test/tmp/case-01/exp/conf/maxent/train.conf --test-config test/tmp/case-01/exp/conf/test.conf --train-threads 1 --test-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/maxent
Prerun Valid Entropy: 8.857643
ITERATION 01: TrEnt 7.654640, lr(0.1/0.005/0.1/0.1), W/s 107.4k, CVEnt: 7.472616
nnet accepted (01.clm)
ITERATION 02: TrEnt 7.323397, lr(0.1/0.005/0.1/0.1), W/s 107.5k, CVEnt: 7.381858
nnet accepted (02.clm)
ITERATION 03: TrEnt 7.192573, lr(0.1/0.005/0.1/0.1), W/s 107.1k, CVEnt: 7.322828
nnet accepted (03.clm)
ITERATION 04: TrEnt 7.099852, lr(0.1/0.005/0.1/0.1), W/s 107.5k, CVEnt: 7.277546
nnet accepted (04.clm)
ITERATION 05: TrEnt 7.025917, lr(0.1/0.005/0.1/0.1), W/s 107.2k, CVEnt: 7.246837
nnet accepted (05.clm)
ITERATION 06: TrEnt 6.965264, lr(0.1/0.005/0.1/0.1), W/s 106.8k, CVEnt: 7.215345
nnet accepted (06.clm)
ITERATION 07: TrEnt 6.911523, lr(0.1/0.005/0.1/0.1), W/s 107.0k, CVEnt: 7.191556
nnet accepted (07.clm)
ITERATION 08: TrEnt 6.863947, lr(0.1/0.005/0.1/0.1), W/s 107.2k, CVEnt: 7.174971
nnet accepted (08.clm)
ITERATION 09: TrEnt 6.825526, lr(0.05/0.0025/0.05/0.05), W/s 107.2k, CVEnt: 7.161882
nnet accepted (09.clm)
ITERATION 10: TrEnt 6.807021, lr(0.025/0.00125/0.025/0.025), W/s 107.2k, CVEnt: 7.154955
nnet accepted (10.clm)
ITERATION 11: TrEnt 6.797898, lr(0.0125/0.000625/0.0125/0.0125), W/s 107.2k, CVEnt: 7.153656
nnet accepted (11.clm)
../steps/train_model.sh: finished, too small rel. improvement .0001815525
../steps/train_model.sh: Succeeded training the Neural Network : test/tmp/case-01/exp/maxent/final.clm
../steps/train_model.sh: Elapse time: 0hr0m10s
../steps/train_model.sh: Effective speed: 89.4k words/sec
../steps/run_standalone.sh: Stage 3 --- Testing model...
../steps/test_model.sh --config-file test/tmp/case-01/exp/conf/test.conf --test-threads 1 test/tmp/case-01/exp/maxent ./data/test
../steps/test_model.sh: Testing model test/tmp/case-01/exp/maxent/final.clm ...
=================================
Test Entropy: 7.040253
Test PPL: 131.621624
Test Speed: 146.5k words/sec
=================================
../steps/test_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Elapse time: 0hr0m11s

Step 3: Train RNN model ...
../steps/run_standalone.sh --class-size  --train-thr 1 --test-thr 1 rnn test/tmp/case-01/exp/conf test/tmp/case-01/exp ./data/train ./data/valid ./data/test
../steps/run_standalone.sh: Stage 1 --- Initialising model...
../steps/init_model.sh --init-config-file test/tmp/case-01/exp/conf/rnn/init.conf --output-config-file test/tmp/case-01/exp/conf/rnn/output.conf --class-size  --hs  --train-file ./data/train --train-config test/tmp/case-01/exp/conf/rnn/train.conf --train-threads 1 test/tmp/case-01/exp/vocab.clm test/tmp/case-01/exp/rnn
../steps/init_model.sh: Initializing model test/tmp/case-01/exp/vocab.clm to test/tmp/case-01/exp/rnn/init.clm ...
../steps/init_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Stage 2 --- Training model...
../steps/train_model.sh --train-config test/tmp/case-01/exp/conf/rnn/train.conf --test-config test/tmp/case-01/exp/conf/test.conf --train-threads 1 --test-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/rnn
Prerun Valid Entropy: 8.921134
ITERATION 01: TrEnt 7.162501, lr(0.1/0.001/0.1/0.1), W/s 30.6k, CVEnt: 7.057830
nnet accepted (01.clm)
ITERATION 02: TrEnt 6.775001, lr(0.1/0.001/0.1/0.1), W/s 30.6k, CVEnt: 6.983799
nnet accepted (02.clm)
ITERATION 03: TrEnt 6.635185, lr(0.1/0.001/0.1/0.1), W/s 30.6k, CVEnt: 6.887352
nnet accepted (03.clm)
ITERATION 04: TrEnt 6.544897, lr(0.1/0.001/0.1/0.1), W/s 30.6k, CVEnt: 6.876019
nnet accepted (04.clm)
ITERATION 05: TrEnt 6.430816, lr(0.05/0.0005/0.05/0.05), W/s 30.7k, CVEnt: 6.822884
nnet accepted (05.clm)
ITERATION 06: TrEnt 6.371416, lr(0.025/0.00025/0.025/0.025), W/s 30.6k, CVEnt: 6.832828
nnet rejected (06.clm)
../steps/train_model.sh: finished, too small rel. improvement 0
../steps/train_model.sh: Succeeded training the Neural Network : test/tmp/case-01/exp/rnn/final.clm
../steps/train_model.sh: Elapse time: 0hr0m17s
../steps/train_model.sh: Effective speed: 28.7k words/sec
../steps/run_standalone.sh: Stage 3 --- Testing model...
../steps/test_model.sh --config-file test/tmp/case-01/exp/conf/test.conf --test-threads 1 test/tmp/case-01/exp/rnn ./data/test
../steps/test_model.sh: Testing model test/tmp/case-01/exp/rnn/final.clm ...
=================================
Test Entropy: 6.699703
Test PPL: 103.946905
Test Speed: 86.7k words/sec
=================================
../steps/test_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Elapse time: 0hr0m18s

Step 4: Train RNN+MaxEnt model ...
../steps/run_standalone.sh --class-size  --train-thr 1 --test-thr 1 rnn+maxent test/tmp/case-01/exp/conf test/tmp/case-01/exp ./data/train ./data/valid ./data/test
../steps/run_standalone.sh: Stage 1 --- Initialising model...
../steps/init_model.sh --init-config-file test/tmp/case-01/exp/conf/rnn+maxent/init.conf --output-config-file test/tmp/case-01/exp/conf/rnn+maxent/output.conf --class-size  --hs  --train-file ./data/train --train-config test/tmp/case-01/exp/conf/rnn+maxent/train.conf --train-threads 1 test/tmp/case-01/exp/vocab.clm test/tmp/case-01/exp/rnn+maxent
../steps/init_model.sh: Initializing model test/tmp/case-01/exp/vocab.clm to test/tmp/case-01/exp/rnn+maxent/init.clm ...
../steps/init_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Stage 2 --- Training model...
../steps/train_model.sh --train-config test/tmp/case-01/exp/conf/rnn+maxent/train.conf --test-config test/tmp/case-01/exp/conf/test.conf --train-threads 1 --test-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/rnn+maxent
Prerun Valid Entropy: 8.876297
ITERATION 01: TrEnt 6.858996, lr(0.5/0.1/0.5/0.5), W/s 27.1k, CVEnt: 6.811690
nnet accepted (01.clm)
ITERATION 02: TrEnt 6.242411, lr(0.5/0.1/0.5/0.5), W/s 27.1k, CVEnt: 6.734508
nnet accepted (02.clm)
ITERATION 03: TrEnt 5.923663, lr(0.5/0.1/0.5/0.5), W/s 27.1k, CVEnt: 6.661636
nnet accepted (03.clm)
ITERATION 04: TrEnt 5.687231, lr(0.5/0.1/0.5/0.5), W/s 27.1k, CVEnt: 6.655251
nnet accepted (04.clm)
ITERATION 05: TrEnt 5.409496, lr(0.25/0.05/0.25/0.25), W/s 27.1k, CVEnt: 6.571876
nnet accepted (05.clm)
ITERATION 06: TrEnt 5.275024, lr(0.125/0.025/0.125/0.125), W/s 27.2k, CVEnt: 6.559115
nnet accepted (06.clm)
ITERATION 07: TrEnt 5.205812, lr(0.0625/0.0125/0.0625/0.0625), W/s 27.1k, CVEnt: 6.553893
nnet accepted (07.clm)
ITERATION 08: TrEnt 5.171668, lr(0.03125/0.00625/0.03125/0.03125), W/s 27.1k, CVEnt: 6.553143
nnet accepted (08.clm)
../steps/train_model.sh: finished, too small rel. improvement .0001144358
../steps/train_model.sh: Succeeded training the Neural Network : test/tmp/case-01/exp/rnn+maxent/final.clm
../steps/train_model.sh: Elapse time: 0hr0m26s
../steps/train_model.sh: Effective speed: 25.0k words/sec
../steps/run_standalone.sh: Stage 3 --- Testing model...
../steps/test_model.sh --config-file test/tmp/case-01/exp/conf/test.conf --test-threads 1 test/tmp/case-01/exp/rnn+maxent ./data/test
../steps/test_model.sh: Testing model test/tmp/case-01/exp/rnn+maxent/final.clm ...
=================================
Test Entropy: 6.439676
Test PPL: 86.803181
Test Speed: 72.6k words/sec
=================================
../steps/test_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Elapse time: 0hr0m26s

Step 5: Train RNN~MaxEnt merge model ...
../steps/run_cascade.sh --class-size  --train-thr 1 --test-thr 1 maxent~rnn test/tmp/case-01/exp/conf test/tmp/case-01/exp ./data/train ./data/valid ./data/test
../steps/run_cascade.sh: Stage 1 --- Training maxent...
../steps/run_standalone.sh --class-size  --train-thr 1 --test-thr 1 maxent test/tmp/case-01/exp/conf/maxent~rnn test/tmp/case-01/exp/maxent~rnn ./data/train ./data/valid ./data/test
../steps/run_standalone.sh: Stage 1 --- Initialising model...
../steps/init_model.sh --init-config-file test/tmp/case-01/exp/conf/maxent~rnn/maxent/init.conf --output-config-file test/tmp/case-01/exp/conf/maxent~rnn/maxent/output.conf --class-size  --hs  --train-file ./data/train --train-config test/tmp/case-01/exp/conf/maxent~rnn/maxent/train.conf --train-threads 1 test/tmp/case-01/exp/maxent~rnn/vocab.clm test/tmp/case-01/exp/maxent~rnn/maxent
../steps/init_model.sh: Initializing model test/tmp/case-01/exp/maxent~rnn/vocab.clm to test/tmp/case-01/exp/maxent~rnn/maxent/init.clm ...
../steps/init_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Stage 2 --- Training model...
../steps/train_model.sh --train-config test/tmp/case-01/exp/conf/maxent~rnn/maxent/train.conf --test-config test/tmp/case-01/exp/conf/maxent~rnn/test.conf --train-threads 1 --test-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/maxent~rnn/maxent
Prerun Valid Entropy: 8.857643
ITERATION 01: TrEnt 7.654640, lr(0.1/0.005/0.1/0.1), W/s 107.2k, CVEnt: 7.472616
nnet accepted (01.clm)
ITERATION 02: TrEnt 7.323397, lr(0.1/0.005/0.1/0.1), W/s 107.0k, CVEnt: 7.381858
nnet accepted (02.clm)
ITERATION 03: TrEnt 7.192573, lr(0.1/0.005/0.1/0.1), W/s 107.5k, CVEnt: 7.322828
nnet accepted (03.clm)
ITERATION 04: TrEnt 7.099852, lr(0.1/0.005/0.1/0.1), W/s 107.4k, CVEnt: 7.277546
nnet accepted (04.clm)
ITERATION 05: TrEnt 7.025917, lr(0.1/0.005/0.1/0.1), W/s 107.4k, CVEnt: 7.246837
nnet accepted (05.clm)
ITERATION 06: TrEnt 6.965264, lr(0.1/0.005/0.1/0.1), W/s 107.2k, CVEnt: 7.215345
nnet accepted (06.clm)
ITERATION 07: TrEnt 6.911523, lr(0.1/0.005/0.1/0.1), W/s 107.2k, CVEnt: 7.191556
nnet accepted (07.clm)
ITERATION 08: TrEnt 6.863947, lr(0.1/0.005/0.1/0.1), W/s 107.1k, CVEnt: 7.174971
nnet accepted (08.clm)
ITERATION 09: TrEnt 6.825526, lr(0.05/0.0025/0.05/0.05), W/s 107.1k, CVEnt: 7.161882
nnet accepted (09.clm)
ITERATION 10: TrEnt 6.807021, lr(0.025/0.00125/0.025/0.025), W/s 107.2k, CVEnt: 7.154955
nnet accepted (10.clm)
ITERATION 11: TrEnt 6.797898, lr(0.0125/0.000625/0.0125/0.0125), W/s 107.2k, CVEnt: 7.153656
nnet accepted (11.clm)
../steps/train_model.sh: finished, too small rel. improvement .0001815525
../steps/train_model.sh: Succeeded training the Neural Network : test/tmp/case-01/exp/maxent~rnn/maxent/final.clm
../steps/train_model.sh: Elapse time: 0hr0m10s
../steps/train_model.sh: Effective speed: 89.4k words/sec
../steps/run_standalone.sh: Stage 3 --- Testing model...
../steps/test_model.sh --config-file test/tmp/case-01/exp/conf/maxent~rnn/test.conf --test-threads 1 test/tmp/case-01/exp/maxent~rnn/maxent ./data/test
../steps/test_model.sh: Testing model test/tmp/case-01/exp/maxent~rnn/maxent/final.clm ...
=================================
Test Entropy: 7.040253
Test PPL: 131.621624
Test Speed: 146.5k words/sec
=================================
../steps/test_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Elapse time: 0hr0m10s
../steps/run_cascade.sh: Stage 2 --- Initializing ...
../steps/run_standalone.sh --hs  false --class-size  100 --stage 1 --train-thr 1 --test-thr 1 rnn test/tmp/case-01/exp/conf/maxent~rnn test/tmp/case-01/exp/maxent~rnn ./data/train ./data/valid ./data/test
../steps/run_standalone.sh: Stage 1 --- Initialising model...
../steps/init_model.sh --init-config-file test/tmp/case-01/exp/conf/maxent~rnn/rnn/init.conf --output-config-file test/tmp/case-01/exp/conf/maxent~rnn/rnn/output.conf --class-size  100 --hs  false --train-file ./data/train --train-config test/tmp/case-01/exp/conf/maxent~rnn/rnn/train.conf --train-threads 1 test/tmp/case-01/exp/maxent~rnn/vocab.clm test/tmp/case-01/exp/maxent~rnn/rnn
../steps/init_model.sh: Initializing model test/tmp/case-01/exp/maxent~rnn/vocab.clm to test/tmp/case-01/exp/maxent~rnn/rnn/init.clm ...
../steps/init_model.sh: Elapse time: 0hr0m1s
../steps/run_standalone.sh: Elapse time: 0hr0m1s
../steps/run_cascade.sh: Stage 2 --- Merging maxent with rnn...
../steps/run_cascade.sh: Stage 2 --- Training maxent~rnn...
../steps/run_standalone.sh --stage 2- --train-thr 1 --test-thr 1 maxent~rnn test/tmp/case-01/exp/conf test/tmp/case-01/exp ./data/train ./data/valid ./data/test
../steps/run_standalone.sh: Stage 2 --- Training model...
../steps/train_model.sh --train-config test/tmp/case-01/exp/conf/maxent~rnn/train.conf --test-config test/tmp/case-01/exp/conf/test.conf --train-threads 1 --test-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/maxent~rnn
Prerun Valid Entropy: 7.163832
ITERATION 01: TrEnt 6.601525, lr(0.5/0.1/0.5/0.5), W/s 27.1k, CVEnt: 6.851982
nnet accepted (01.clm)
ITERATION 02: TrEnt 6.155683, lr(0.5/0.1/0.5/0.5), W/s 27.1k, CVEnt: 6.797705
nnet accepted (02.clm)
ITERATION 03: TrEnt 5.870544, lr(0.5/0.1/0.5/0.5), W/s 27.1k, CVEnt: 6.715120
nnet accepted (03.clm)
ITERATION 04: TrEnt 5.648058, lr(0.5/0.1/0.5/0.5), W/s 27.1k, CVEnt: 6.696350
nnet accepted (04.clm)
ITERATION 05: TrEnt 5.397449, lr(0.25/0.05/0.25/0.25), W/s 27.1k, CVEnt: 6.623775
nnet accepted (05.clm)
ITERATION 06: TrEnt 5.275825, lr(0.125/0.025/0.125/0.125), W/s 27.1k, CVEnt: 6.613902
nnet accepted (06.clm)
ITERATION 07: TrEnt 5.213352, lr(0.0625/0.0125/0.0625/0.0625), W/s 27.1k, CVEnt: 6.604471
nnet accepted (07.clm)
ITERATION 08: TrEnt 5.182425, lr(0.03125/0.00625/0.03125/0.03125), W/s 27.1k, CVEnt: 6.604307
nnet accepted (08.clm)
../steps/train_model.sh: finished, too small rel. improvement .0000248316
../steps/train_model.sh: Succeeded training the Neural Network : test/tmp/case-01/exp/maxent~rnn/final.clm
../steps/train_model.sh: Elapse time: 0hr0m26s
../steps/train_model.sh: Effective speed: 25.0k words/sec
../steps/run_standalone.sh: Stage 3 --- Testing model...
../steps/test_model.sh --config-file test/tmp/case-01/exp/conf/test.conf --test-threads 1 test/tmp/case-01/exp/maxent~rnn ./data/test
../steps/test_model.sh: Testing model test/tmp/case-01/exp/maxent~rnn/final.clm ...
=================================
Test Entropy: 6.480929
Test PPL: 89.321097
Test Speed: 72.6k words/sec
=================================
../steps/test_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Elapse time: 0hr0m26s
../steps/run_cascade.sh: Elapse time: 0hr0m37s
