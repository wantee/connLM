
Step 1: Learn Vocab ...
../steps/learn_vocab.sh --config-file test/tmp/case-01/exp/conf/vocab.conf ./data/train test/tmp/case-01/exp
../steps/learn_vocab.sh: Learning vocab test/tmp/case-01/exp/vocab.clm from ./data/train
=================================
Words:  81350
Vocab size:  3721
=================================
../steps/learn_vocab.sh: Elapse time: 0hr0m2s

Step 2: Train MaxEnt model ...
../steps/run_standalone.sh --class-size  --train-thr 1 --eval-thr 1 maxent test/tmp/case-01/exp/conf test/tmp/case-01/exp ./data/train ./data/valid ./data/test
../steps/run_standalone.sh: Stage 1 --- Initialising model...
../steps/init_model.sh --init-config-file test/tmp/case-01/exp/conf/maxent/init.conf --output-config-file test/tmp/case-01/exp/conf/maxent/output.conf --class-size  --hs  --train-file ./data/train --train-config test/tmp/case-01/exp/conf/maxent/train.conf --train-threads 1 test/tmp/case-01/exp/vocab.clm test/tmp/case-01/exp/maxent
../steps/init_model.sh: Initializing model test/tmp/case-01/exp/vocab.clm to test/tmp/case-01/exp/maxent/init.clm ...
../steps/init_model.sh: Elapse time: 0hr0m1s
../steps/run_standalone.sh: Stage 2 --- Training model...
../steps/train_model.sh --train-config test/tmp/case-01/exp/conf/maxent/train.conf --eval-config test/tmp/case-01/exp/conf/eval.conf --train-threads 1 --eval-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/maxent
Prerun Valid Entropy: 8.857732
ITERATION 01: TrEnt 7.654829, lr(0.1/0.005/0.1/0.1), W/s 118.7k, CVEnt: 7.473052
nnet accepted (01.clm)
ITERATION 02: TrEnt 7.323919, lr(0.1/0.005/0.1/0.1), W/s 112.3k, CVEnt: 7.382656
nnet accepted (02.clm)
ITERATION 03: TrEnt 7.193449, lr(0.1/0.005/0.1/0.1), W/s 114.0k, CVEnt: 7.323851
nnet accepted (03.clm)
ITERATION 04: TrEnt 7.100913, lr(0.1/0.005/0.1/0.1), W/s 115.5k, CVEnt: 7.278992
nnet accepted (04.clm)
ITERATION 05: TrEnt 7.027097, lr(0.1/0.005/0.1/0.1), W/s 115.6k, CVEnt: 7.247929
nnet accepted (05.clm)
ITERATION 06: TrEnt 6.966545, lr(0.1/0.005/0.1/0.1), W/s 116.8k, CVEnt: 7.216395
nnet accepted (06.clm)
ITERATION 07: TrEnt 6.912962, lr(0.1/0.005/0.1/0.1), W/s 113.2k, CVEnt: 7.192877
nnet accepted (07.clm)
ITERATION 08: TrEnt 6.865280, lr(0.1/0.005/0.1/0.1), W/s 111.7k, CVEnt: 7.176243
nnet accepted (08.clm)
ITERATION 09: TrEnt 6.826944, lr(0.05/0.0025/0.05/0.05), W/s 115.3k, CVEnt: 7.163259
nnet accepted (09.clm)
ITERATION 10: TrEnt 6.808512, lr(0.025/0.00125/0.025/0.025), W/s 114.7k, CVEnt: 7.156305
nnet accepted (10.clm)
ITERATION 11: TrEnt 6.799402, lr(0.0125/0.000625/0.0125/0.0125), W/s 117.1k, CVEnt: 7.154985
nnet accepted (11.clm)
../steps/train_model.sh: finished, too small rel. improvement .0001844527
../steps/train_model.sh: Succeeded training the Neural Network : test/tmp/case-01/exp/maxent/final.clm
../steps/train_model.sh: Elapse time: 0hr0m10s
../steps/train_model.sh: Effective speed: 89.4k words/sec
../steps/run_standalone.sh: Stage 3 --- Testing model...
../steps/eval_model.sh --config-file test/tmp/case-01/exp/conf/eval.conf --eval-threads 1 test/tmp/case-01/exp/maxent ./data/test
../steps/eval_model.sh: Evaluating model test/tmp/case-01/exp/maxent/final.clm ...
=================================
Eval Entropy: 7.040397
Eval PPL: 131.634756
Eval Speed: 137.0k words/sec
=================================
../steps/eval_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Elapse time: 0hr0m12s

Step 3: Train RNN model ...
../steps/run_standalone.sh --class-size  --train-thr 1 --eval-thr 1 rnn test/tmp/case-01/exp/conf test/tmp/case-01/exp ./data/train ./data/valid ./data/test
../steps/run_standalone.sh: Stage 1 --- Initialising model...
../steps/init_model.sh --init-config-file test/tmp/case-01/exp/conf/rnn/init.conf --output-config-file test/tmp/case-01/exp/conf/rnn/output.conf --class-size  --hs  --train-file ./data/train --train-config test/tmp/case-01/exp/conf/rnn/train.conf --train-threads 1 test/tmp/case-01/exp/vocab.clm test/tmp/case-01/exp/rnn
../steps/init_model.sh: Initializing model test/tmp/case-01/exp/vocab.clm to test/tmp/case-01/exp/rnn/init.clm ...
../steps/init_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Stage 2 --- Training model...
../steps/train_model.sh --train-config test/tmp/case-01/exp/conf/rnn/train.conf --eval-config test/tmp/case-01/exp/conf/eval.conf --train-threads 1 --eval-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/rnn
Prerun Valid Entropy: 8.920433
ITERATION 01: TrEnt 7.164948, lr(0.1/0.001/0.1/0.1), W/s 38.9k, CVEnt: 7.061173
nnet accepted (01.clm)
ITERATION 02: TrEnt 6.772988, lr(0.1/0.001/0.1/0.1), W/s 39.1k, CVEnt: 6.989723
nnet accepted (02.clm)
ITERATION 03: TrEnt 6.637760, lr(0.1/0.001/0.1/0.1), W/s 35.3k, CVEnt: 6.902609
nnet accepted (03.clm)
ITERATION 04: TrEnt 6.551342, lr(0.1/0.001/0.1/0.1), W/s 39.2k, CVEnt: 6.876031
nnet accepted (04.clm)
ITERATION 05: TrEnt 6.485804, lr(0.1/0.001/0.1/0.1), W/s 35.9k, CVEnt: 6.815202
nnet accepted (05.clm)
ITERATION 06: TrEnt 6.435061, lr(0.1/0.001/0.1/0.1), W/s 37.6k, CVEnt: 6.855649
nnet rejected (06.clm)
ITERATION 07: TrEnt 6.388140, lr(0.05/0.0005/0.05/0.05), W/s 40.0k, CVEnt: 6.835431
nnet rejected (07.clm)
../steps/train_model.sh: finished, too small rel. improvement 0
../steps/train_model.sh: Succeeded training the Neural Network : test/tmp/case-01/exp/rnn/final.clm
../steps/train_model.sh: Elapse time: 0hr0m17s
../steps/train_model.sh: Effective speed: 33.4k words/sec
../steps/run_standalone.sh: Stage 3 --- Testing model...
../steps/eval_model.sh --config-file test/tmp/case-01/exp/conf/eval.conf --eval-threads 1 test/tmp/case-01/exp/rnn ./data/test
../steps/eval_model.sh: Evaluating model test/tmp/case-01/exp/rnn/final.clm ...
=================================
Eval Entropy: 6.706473
Eval PPL: 104.435864
Eval Speed: 94.4k words/sec
=================================
../steps/eval_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Elapse time: 0hr0m17s

Step 4: Train RNN+MaxEnt model ...
../steps/run_standalone.sh --class-size  --train-thr 1 --eval-thr 1 rnn+maxent test/tmp/case-01/exp/conf test/tmp/case-01/exp ./data/train ./data/valid ./data/test
../steps/run_standalone.sh: Stage 1 --- Initialising model...
../steps/init_model.sh --init-config-file test/tmp/case-01/exp/conf/rnn+maxent/init.conf --output-config-file test/tmp/case-01/exp/conf/rnn+maxent/output.conf --class-size  --hs  --train-file ./data/train --train-config test/tmp/case-01/exp/conf/rnn+maxent/train.conf --train-threads 1 test/tmp/case-01/exp/vocab.clm test/tmp/case-01/exp/rnn+maxent
../steps/init_model.sh: Initializing model test/tmp/case-01/exp/vocab.clm to test/tmp/case-01/exp/rnn+maxent/init.clm ...
../steps/init_model.sh: Elapse time: 0hr0m1s
../steps/run_standalone.sh: Stage 2 --- Training model...
../steps/train_model.sh --train-config test/tmp/case-01/exp/conf/rnn+maxent/train.conf --eval-config test/tmp/case-01/exp/conf/eval.conf --train-threads 1 --eval-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/rnn+maxent
Prerun Valid Entropy: 8.875850
ITERATION 01: TrEnt 6.856894, lr(0.5/0.1/0.5/0.5), W/s 35.7k, CVEnt: 6.798490
nnet accepted (01.clm)
ITERATION 02: TrEnt 6.228457, lr(0.5/0.1/0.5/0.5), W/s 35.3k, CVEnt: 6.780083
nnet accepted (02.clm)
ITERATION 03: TrEnt 5.845812, lr(0.25/0.05/0.25/0.25), W/s 34.4k, CVEnt: 6.632711
nnet accepted (03.clm)
ITERATION 04: TrEnt 5.672494, lr(0.125/0.025/0.125/0.125), W/s 35.2k, CVEnt: 6.603040
nnet accepted (04.clm)
ITERATION 05: TrEnt 5.585223, lr(0.0625/0.0125/0.0625/0.0625), W/s 35.4k, CVEnt: 6.594870
nnet accepted (05.clm)
ITERATION 06: TrEnt 5.542980, lr(0.03125/0.00625/0.03125/0.03125), W/s 34.8k, CVEnt: 6.584975
nnet accepted (06.clm)
ITERATION 07: TrEnt 5.520324, lr(0.015625/0.003125/0.015625/0.015625), W/s 34.5k, CVEnt: 6.581154
nnet accepted (07.clm)
ITERATION 08: TrEnt 5.509347, lr(0.0078125/0.0015625/0.0078125/0.0078125), W/s 34.0k, CVEnt: 6.581264
nnet rejected (08.clm)
../steps/train_model.sh: finished, too small rel. improvement 0
../steps/train_model.sh: Succeeded training the Neural Network : test/tmp/case-01/exp/rnn+maxent/final.clm
../steps/train_model.sh: Elapse time: 0hr0m21s
../steps/train_model.sh: Effective speed: 30.9k words/sec
../steps/run_standalone.sh: Stage 3 --- Testing model...
../steps/eval_model.sh --config-file test/tmp/case-01/exp/conf/eval.conf --eval-threads 1 test/tmp/case-01/exp/rnn+maxent ./data/test
../steps/eval_model.sh: Evaluating model test/tmp/case-01/exp/rnn+maxent/final.clm ...
=================================
Eval Entropy: 6.442406
Eval PPL: 86.967598
Eval Speed: 79.4k words/sec
=================================
../steps/eval_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Elapse time: 0hr0m22s

Step 5: Train RNN~MaxEnt merge model ...
../steps/run_cascade.sh --class-size  --train-thr 1 --eval-thr 1 maxent~rnn test/tmp/case-01/exp/conf test/tmp/case-01/exp ./data/train ./data/valid ./data/test
../steps/run_cascade.sh: Stage 1 --- Training maxent...
../steps/run_standalone.sh --class-size  --train-thr 1 --eval-thr 1 maxent test/tmp/case-01/exp/conf/maxent~rnn test/tmp/case-01/exp/maxent~rnn ./data/train ./data/valid ./data/test
../steps/run_standalone.sh: Stage 1 --- Initialising model...
../steps/init_model.sh --init-config-file test/tmp/case-01/exp/conf/maxent~rnn/maxent/init.conf --output-config-file test/tmp/case-01/exp/conf/maxent~rnn/maxent/output.conf --class-size  --hs  --train-file ./data/train --train-config test/tmp/case-01/exp/conf/maxent~rnn/maxent/train.conf --train-threads 1 test/tmp/case-01/exp/maxent~rnn/vocab.clm test/tmp/case-01/exp/maxent~rnn/maxent
../steps/init_model.sh: Initializing model test/tmp/case-01/exp/maxent~rnn/vocab.clm to test/tmp/case-01/exp/maxent~rnn/maxent/init.clm ...
../steps/init_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Stage 2 --- Training model...
../steps/train_model.sh --train-config test/tmp/case-01/exp/conf/maxent~rnn/maxent/train.conf --eval-config test/tmp/case-01/exp/conf/maxent~rnn/eval.conf --train-threads 1 --eval-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/maxent~rnn/maxent
Prerun Valid Entropy: 8.857732
ITERATION 01: TrEnt 7.654829, lr(0.1/0.005/0.1/0.1), W/s 115.8k, CVEnt: 7.473052
nnet accepted (01.clm)
ITERATION 02: TrEnt 7.323919, lr(0.1/0.005/0.1/0.1), W/s 134.2k, CVEnt: 7.382656
nnet accepted (02.clm)
ITERATION 03: TrEnt 7.193449, lr(0.1/0.005/0.1/0.1), W/s 118.5k, CVEnt: 7.323851
nnet accepted (03.clm)
ITERATION 04: TrEnt 7.100913, lr(0.1/0.005/0.1/0.1), W/s 115.8k, CVEnt: 7.278992
nnet accepted (04.clm)
ITERATION 05: TrEnt 7.027097, lr(0.1/0.005/0.1/0.1), W/s 118.3k, CVEnt: 7.247929
nnet accepted (05.clm)
ITERATION 06: TrEnt 6.966545, lr(0.1/0.005/0.1/0.1), W/s 112.4k, CVEnt: 7.216395
nnet accepted (06.clm)
ITERATION 07: TrEnt 6.912962, lr(0.1/0.005/0.1/0.1), W/s 119.4k, CVEnt: 7.192877
nnet accepted (07.clm)
ITERATION 08: TrEnt 6.865280, lr(0.1/0.005/0.1/0.1), W/s 115.3k, CVEnt: 7.176243
nnet accepted (08.clm)
ITERATION 09: TrEnt 6.826944, lr(0.05/0.0025/0.05/0.05), W/s 141.1k, CVEnt: 7.163259
nnet accepted (09.clm)
ITERATION 10: TrEnt 6.808512, lr(0.025/0.00125/0.025/0.025), W/s 120.3k, CVEnt: 7.156305
nnet accepted (10.clm)
ITERATION 11: TrEnt 6.799402, lr(0.0125/0.000625/0.0125/0.0125), W/s 117.3k, CVEnt: 7.154985
nnet accepted (11.clm)
../steps/train_model.sh: finished, too small rel. improvement .0001844527
../steps/train_model.sh: Succeeded training the Neural Network : test/tmp/case-01/exp/maxent~rnn/maxent/final.clm
../steps/train_model.sh: Elapse time: 0hr0m10s
../steps/train_model.sh: Effective speed: 89.4k words/sec
../steps/run_standalone.sh: Stage 3 --- Testing model...
../steps/eval_model.sh --config-file test/tmp/case-01/exp/conf/maxent~rnn/eval.conf --eval-threads 1 test/tmp/case-01/exp/maxent~rnn/maxent ./data/test
../steps/eval_model.sh: Evaluating model test/tmp/case-01/exp/maxent~rnn/maxent/final.clm ...
=================================
Eval Entropy: 7.040397
Eval PPL: 131.634756
Eval Speed: 149.0k words/sec
=================================
../steps/eval_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Elapse time: 0hr0m11s
../steps/run_cascade.sh: Stage 2 --- Initializing ...
../steps/run_standalone.sh --hs  false --class-size  100 --stage 1 --train-thr 1 --eval-thr 1 rnn test/tmp/case-01/exp/conf/maxent~rnn test/tmp/case-01/exp/maxent~rnn ./data/train ./data/valid ./data/test
../steps/run_standalone.sh: Stage 1 --- Initialising model...
../steps/init_model.sh --init-config-file test/tmp/case-01/exp/conf/maxent~rnn/rnn/init.conf --output-config-file test/tmp/case-01/exp/conf/maxent~rnn/rnn/output.conf --class-size  100 --hs  false --train-file ./data/train --train-config test/tmp/case-01/exp/conf/maxent~rnn/rnn/train.conf --train-threads 1 test/tmp/case-01/exp/maxent~rnn/vocab.clm test/tmp/case-01/exp/maxent~rnn/rnn
../steps/init_model.sh: Initializing model test/tmp/case-01/exp/maxent~rnn/vocab.clm to test/tmp/case-01/exp/maxent~rnn/rnn/init.clm ...
../steps/init_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Elapse time: 0hr0m0s
../steps/run_cascade.sh: Stage 2 --- Merging maxent with rnn...
../steps/run_cascade.sh: Stage 2 --- Training maxent~rnn...
../steps/run_standalone.sh --stage 2- --train-thr 1 --eval-thr 1 maxent~rnn test/tmp/case-01/exp/conf test/tmp/case-01/exp ./data/train ./data/valid ./data/test
../steps/run_standalone.sh: Stage 2 --- Training model...
../steps/train_model.sh --train-config test/tmp/case-01/exp/conf/maxent~rnn/train.conf --eval-config test/tmp/case-01/exp/conf/eval.conf --train-threads 1 --eval-threads 1 ./data/train ./data/valid test/tmp/case-01/exp/maxent~rnn
Prerun Valid Entropy: 7.164819
ITERATION 01: TrEnt 6.606927, lr(0.5/0.1/0.5/0.5), W/s 34.9k, CVEnt: 6.854618
nnet accepted (01.clm)
ITERATION 02: TrEnt 6.165373, lr(0.5/0.1/0.5/0.5), W/s 35.8k, CVEnt: 6.815288
nnet accepted (02.clm)
ITERATION 03: TrEnt 5.881359, lr(0.5/0.1/0.5/0.5), W/s 35.2k, CVEnt: 6.731702
nnet accepted (03.clm)
ITERATION 04: TrEnt 5.659295, lr(0.5/0.1/0.5/0.5), W/s 33.0k, CVEnt: 6.705827
nnet accepted (04.clm)
ITERATION 05: TrEnt 5.468030, lr(0.5/0.1/0.5/0.5), W/s 34.4k, CVEnt: 6.651286
nnet accepted (05.clm)
ITERATION 06: TrEnt 5.306753, lr(0.5/0.1/0.5/0.5), W/s 33.4k, CVEnt: 6.691625
nnet rejected (06.clm)
ITERATION 07: TrEnt 5.239370, lr(0.25/0.05/0.25/0.25), W/s 34.3k, CVEnt: 6.647591
nnet accepted (07.clm)
ITERATION 08: TrEnt 5.124699, lr(0.125/0.025/0.125/0.125), W/s 34.5k, CVEnt: 6.631928
nnet accepted (08.clm)
ITERATION 09: TrEnt 5.066387, lr(0.0625/0.0125/0.0625/0.0625), W/s 35.0k, CVEnt: 6.606761
nnet accepted (09.clm)
ITERATION 10: TrEnt 5.036576, lr(0.03125/0.00625/0.03125/0.03125), W/s 35.5k, CVEnt: 6.600792
nnet accepted (10.clm)
ITERATION 11: TrEnt 5.021188, lr(0.015625/0.003125/0.015625/0.015625), W/s 33.4k, CVEnt: 6.596813
nnet accepted (11.clm)
ITERATION 12: TrEnt 5.013288, lr(0.0078125/0.0015625/0.0078125/0.0078125), W/s 35.7k, CVEnt: 6.598523
nnet rejected (12.clm)
../steps/train_model.sh: finished, too small rel. improvement 0
../steps/train_model.sh: Succeeded training the Neural Network : test/tmp/case-01/exp/maxent~rnn/final.clm
../steps/train_model.sh: Elapse time: 0hr0m32s
../steps/train_model.sh: Effective speed: 30.4k words/sec
../steps/run_standalone.sh: Stage 3 --- Testing model...
../steps/eval_model.sh --config-file test/tmp/case-01/exp/conf/eval.conf --eval-threads 1 test/tmp/case-01/exp/maxent~rnn ./data/test
../steps/eval_model.sh: Evaluating model test/tmp/case-01/exp/maxent~rnn/final.clm ...
=================================
Eval Entropy: 6.477094
Eval PPL: 89.083993
Eval Speed: 81.7k words/sec
=================================
../steps/eval_model.sh: Elapse time: 0hr0m0s
../steps/run_standalone.sh: Elapse time: 0hr0m32s
../steps/run_cascade.sh: Elapse time: 0hr0m43s
